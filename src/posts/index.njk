---
layout: base
eleventyNavigation:
  key: Articles
  order: 3
pagination:
  data: collections.post
  size: 10
  alias: posts
  addAllPagesToCollections: true
permalink: "/posts{% if pagination.pageNumber > 0 %}/{{ pagination.pageNumber }}/{% endif %}/"
meta:
  title: Articles Archive
  description: Explore our collection of thought-provoking articles on culture, society, and human experience.
---

<!-- Pagination data for Alpine.js -->
<script>
  window.paginationInfo = {
    currentPage: {{ pagination.pageNumber }},
    totalPages: {{ pagination.pages.length }},
    next: '{{pagination.href.next}}',
    previous: '{{pagination.href.previous}}'
  };
  console.log('Pagination info:', window.paginationInfo);
</script>

<section class="mt-12 py-16 px-4 mx-auto max-w-screen-xl" 
         x-data="articlesGrid()"
         x-init="init()">
  <div class="mx-auto max-w-screen-sm text-center mb-12">
    <h1 class="mb-4 text-4xl tracking-tight text-gray-900 dark:text-white">Essays & Articles</h1>
    <p class="font-light text-gray-500 sm:text-xl dark:text-gray-400">Exploring the intersections of culture, society, and human experience</p>
  </div>

  <div class="grid gap-12" id="articles-grid">
    {% for post in posts %}
      {% if loop.index == 1 or loop.index == 2 or loop.index == 6 or loop.index == 7 %}
        {% if loop.index == 1 or loop.index == 6 %}
          <div class="grid gap-12 md:grid-cols-2">
        {% endif %}
        <!-- Horizontal cards for first and third rows (desktop only) -->
        <article class="card md:card-side card-border bg-base-200 shadow-lg group relative overflow-hidden">
          {% set heroMatch = post.templateContent | regexFind('<img[^>]+src="([^">]+)"') %}
          {% set heroImage = heroMatch and heroMatch[1] %}
          {% if heroImage %}
            <figure class="h-60 md:h-full w-full md:w-2/5 overflow-hidden">
              {% if 'unsplash.com' in heroImage %}
                {% set transformedUrl = heroImage ~ '&w=800&h=600' %}
                <img src="{{ transformedUrl }}" 
                     alt="{{ post.data.title }}"
                     class="object-cover w-full h-full transition duration-300 group-hover:scale-105"
                     loading="lazy"
                     decoding="async">
              {% else %}
                <img src="{{ heroImage | replace('upload/', 'upload/c_fill,w_800,h_450,g_auto,q_auto,f_auto/') }}" 
                     alt="{{ post.data.title }}"
                     class="object-cover w-full h-full transition duration-300 group-hover:scale-105"
                     loading="lazy"
                     decoding="async">
              {% endif %}
            </figure>
          {% endif %}
          <div class="card-body w-full md:w-3/5">
            <div class="flex flex-wrap items-center gap-2 mb-4">
              {% for tag in post.data.tags %}
                <span class="badge badge-soft {% if loop.first %}badge-primary{% else %}badge-secondary{% endif %}">
                  {{ tag }}
                </span>
              {% endfor %}
            </div>
            <h2 class="card-title mb-3 text-2xl font-bold tracking-tight text-base-content">
              <a href="{{post.url}}" class="hover:underline">{{ post.data.title }}</a>
            </h2>
            <p class="mb-4 text-base-content/80">
              {{ post.data.meta_description }}
            </p>
            <div class="card-actions flex items-center justify-between">
              <div class="flex items-center space-x-4">
                <div class="text-sm text-base-content/60">
                  {{ post.data.published_date | formatDate }}
                </div>
              </div>
              <a href="{{post.url}}" class="inline-flex items-center text-sm font-medium text-primary hover:text-primary-focus">
                Read essay
                <svg class="ml-2 h-4 w-4" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                </svg>
              </a>
            </div>
          </div>
        </article>
        {% if loop.index == 2 or loop.index == 7 %}
          </div>
        {% endif %}
      {% else %}
        {% if loop.index == 3 or loop.index == 8 %}
          <div class="grid gap-12 md:grid-cols-3">
        {% endif %}
        <!-- Vertical cards for second and fourth rows -->
        <article class="card card-border bg-base-200 shadow-lg group relative  overflow-hidden">
          {% set heroMatch = post.templateContent | regexFind('<img[^>]+src="([^">]+)"') %}
          {% set heroImage = heroMatch and heroMatch[1] %}
          {% if heroImage %}
            <figure class="h-60 w-full overflow-hidden">
              {% if 'unsplash.com' in heroImage %}
                {% set transformedUrl = heroImage ~ '&w=800&h=600' %}
                <img src="{{ transformedUrl }}" 
                     alt="{{ post.data.title }}"
                     class="object-cover w-full h-full transition duration-300 group-hover:scale-105"
                     loading="lazy"
                     decoding="async">
              {% else %}
                <img src="{{ heroImage | replace('upload/', 'upload/c_fill,w_800,h_450,g_auto,q_auto,f_auto/') }}" 
                     alt="{{ post.data.title }}"
                     class="object-cover w-full h-full transition duration-300 group-hover:scale-105"
                     loading="lazy"
                     decoding="async">
              {% endif %}
            </figure>
          {% endif %}
          <div class="card-body">
            <div class="flex flex-wrap items-center gap-2 mb-4">
              {% for tag in post.data.tags %}
                <span class="badge badge-soft {% if loop.first %}badge-primary{% else %}badge-secondary{% endif %}">
                  {{ tag }}
                </span>
              {% endfor %}
            </div>
            <h2 class="card-title mb-3 text-2xl font-bold tracking-tight text-base-content">
              <a href="{{post.url}}" class="hover:underline">{{ post.data.title }}</a>
            </h2>
            <p class="mb-4 text-base-content/80">
              {{ post.data.meta_description }}
            </p>
            <div class="card-actions flex items-center justify-between">
              <div class="flex items-center space-x-4">
                <div class="text-sm text-base-content/60">
                  {{ post.data.published_date | formatDate }}
                </div>
              </div>
              <a href="{{post.url}}" class="inline-flex items-center text-sm font-medium text-primary hover:text-primary-focus">
                Read essay
                <svg class="ml-2 h-4 w-4" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                  <path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414 0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                </svg>
              </a>
            </div>
          </div>
        </article>
        {% if loop.index == 5 or loop.index == 10 %}
          </div>
        {% endif %}
      {% endif %}
    {% endfor %}
  </div>

  <!-- Loading trigger -->
  <div x-show="isMobile" 
       x-intersect.margin.100px="loadMoreArticles()"
       class="h-4 w-full">
  </div>

  <!-- Loading indicator -->
  <div x-show="isLoading" 
       x-transition
       class="flex justify-center items-center mt-8">
    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900 dark:border-white"></div>
  </div>

  <!-- No more articles message -->
  <div x-show="showBackToTop && !isLoading" 
       x-transition
       class="flex justify-center items-center mt-8">
    <a href="#" 
       @click.prevent="window.scrollTo({top: 0, behavior: 'smooth'})"
       class="inline-flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">
      <svg class="w-3.5 h-3.5 mr-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10">
        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5H1m0 0 4 4M1 5l4-4"/>
      </svg>
      Back to top
    </a>
  </div>

  <!-- Pagination (desktop only) -->
  <div class="flex justify-center items-center space-x-4 mt-12" 
       x-show="!isMobile" 
       x-transition>
    {% if pagination.href.previous %}
      <a href="{{pagination.href.previous}}" class="inline-flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">
        <svg class="w-3.5 h-3.5 mr-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 5H1m0 0 4 4M1 5l4-4"/>
        </svg>
        Previous
      </a>
    {% endif %}
    {% if pagination.href.next %}
      <a href="{{pagination.href.next}}" class="inline-flex items-center px-4 py-2 text-sm font-medium text-gray-500 bg-white border border-gray-300 rounded-lg hover:bg-gray-100 hover:text-gray-700 dark:bg-gray-800 dark:border-gray-700 dark:text-gray-400 dark:hover:bg-gray-700 dark:hover:text-white">
        Next
        <svg class="w-3.5 h-3.5 ml-2" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 10">
          <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 5h12m0 0L9 1m4 4L9 9"/>
        </svg>
      </a>
    {% endif %}
  </div>
</section>